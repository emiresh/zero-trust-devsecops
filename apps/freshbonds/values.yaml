app:
  name: freshbonds

namespace: dev

secrets:
  # MongoDB connection string for product-service
  MONGODB_URI: "mongodb+srv://admin:Iresh1998@dev.qzhiudx.mongodb.net/?appName=Dev"
  
  # JWT Secret for user-service (must be at least 32 characters)
  JWT_SECRET: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9aGVsbG93b3JsZDEyMzQ1Njc4OTA"
  
  # IPG Payment Gateway Configuration
  IPG_APP_NAME: "FreshBonds"
  IPG_APP_ID: "WO1411908F4204BD4A83D"
  IPG_APP_TOKEN: "c19aa03307d168525ceb1cd0be6a5d785f1a92962ce67e22c7b46b533e002a6c5281a2e2f96de3c8.443G11908F4204BD4A871"
  IPG_HASH_SALT: "6OQC11908F4204BD4A85D"
  IPG_CALLBACK_URL: "https://freshbonds.com/api/payment-callback"
  IPG_CALLBACK_TOKEN: "fbonds_cbk_T0k3n_2025!@#"
  
  # Environment
  NODE_ENV: "production"

deployments:
  - name: apigateway
    replicaCount: 2
    image:
      repository: emiresh/freshbonds-api-gateway
      tag: latest
      pullPolicy: IfNotPresent
    service:
      name: apigateway-service
      port: 8080
      targetPort: 8080
    ingress:
      enabled: false
    envFrom:
      - secretRef:
          name: freshbonds-secrets
    env:
      - name: USER_SERVICE_URL
        value: "http://user-service:8082"
      - name: PRODUCT_SERVICE_URL
        value: "http://product-service:8081"
      - name: PORT
        value: "8080"

  - name: frontend
    replicaCount: 2
    image:
      repository: emiresh/freshbonds-frontend
      tag: latest
      pullPolicy: IfNotPresent
    service:
      name: frontend-service
      port: 80
      targetPort: 3000
    ingress:
      enabled: true
      path: /
      pathType: Prefix
    env:
      - name: API_GATEWAY_HOST
        value: "apigateway-service"
      - name: API_GATEWAY_PORT
        value: "8080"
      - name: REACT_APP_API_URL
        value: "http://apigateway-service:8080"
      - name: NODE_ENV
        value: "production"

  - name: product-service
    replicaCount: 2
    image:
      repository: emiresh/freshbonds-product-service
      tag: latest
      pullPolicy: IfNotPresent
    service:
      name: product-service
      port: 8081
      targetPort: 3002
    ingress:
      enabled: false
    envFrom:
      - secretRef:
          name: freshbonds-secrets
    env:
      - name: SERVICE_PORT
        value: "3002"

  - name: user-service
    replicaCount: 2
    image:
      repository: emiresh/freshbonds-user-service
      tag: latest
      pullPolicy: IfNotPresent
    service:
      name: user-service
      port: 8082
      targetPort: 3001
    ingress:
      enabled: false
    envFrom:
      - secretRef:
          name: freshbonds-secrets
    env:
      - name: SERVICE_PORT
        value: "3001"

ingress:
  className: nginx
  host: freshbonds.com
  sslRedirect: false
  forceSslRedirect: true
  rewriteTarget: /
  tls:
    enabled: true
    clusterIssuer: letsencrypt
    secretName: freshbonds-tls
